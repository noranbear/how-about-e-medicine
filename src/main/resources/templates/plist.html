<!DOCTYPE html>
<!--
=========================================================
* Material Dashboard 2 - v3.0.4
=========================================================

* Product Page: https://www.creative-tim.com/product/material-dashboard
* Copyright 2022 Creative Tim (https://www.creative-tim.com)
* Licensed under MIT (https://www.creative-tim.com/license)
* Coded by Creative Tim

=========================================================

* The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
-->
<!-- Version: 2.3 -->
<!-- Description: 처방내역 페이지

-------------------------------------------------------------------------
	Date			 Author							Note
-------------------------------------------------------------------------								    
2022. 7. 18.		qwaszx357				  tables.html 가져옴

2022. 7. 19.									출력 기능 구현
					
2022. 7. 19.		noranbear			  카드에 링크 걸기 및 스타일 수정

2022. 7. 22.		qwaszx357					footer 지우기

													row 변경

-------------------------------------------------------------------------
-->

<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<meta charset="utf-8">
<title>Material Dashboard 2 by Creative Tim</title>

<!-- CSS Files -->
<link href="./assets/ezocss/plistcss.css" rel="stylesheet" />

<script>
$(document).ready(function(){
	var pid = $('#pid').text();
	var html = "";
	
	$.ajax({
		method: 'GET',
		url:'/donegage',
		data:{'pid':pid},
		success:function(data){
			// alert(data);
			if (data != 0) {
				html += "<div id='bar' class='progress-bar' role='progressbar' aria-valuenow='70' aria-valuemin='0' aria-valuemax='100' style='width:" + data + "%'>";
				html += "<span class='text-center'>순응도 : " + data + " %</span></div>";
			} else {
				html += "<div class='text-center w-100'><span>순응도 : 0 %</span></div>";
			}
			$('#bar_div').html(html);
			
		},
		error: function(error) {
			// alert("error");
		}
		
	});
});

</script>

<!-- 추가 버튼 -->
<div class="btn-div">
	<button type="button" class="btn bg-gradient-primary" th:onclick="|location.href='@{/padd}'|">
		<i class='fas fa-plus' style='font-size:18px'></i>
	</button>
</div>

<div class="row col-6" th:each="u:${ulist}">
	<div class="col-12">
		<!-- 복용중 -->
		<div class="cardup card my-4" th:if="${u.status == '복용중'}" th:onclick="|location.href='@{/pdetail(id=${u.id})}'|">
			<div id="pname" class="card-header p-0 position-relative mt-n4 mx-3 z-index-2">
				<div class="bg-gradient-primary shadow-primary border-radius-lg pt-4 pb-3">
					<h6 class="text-white text-capitalize ps-3" th:text="${u.hospital} + ' / ' + ${u.pdate}">
					처방 내역</h6>
					<p th:attrappend="id='p'+ ${u.id}" th:text="${u.id}" hidden="hidden"></p>
				</div>
			</div>
			<div class="card-body px-0 pb-2">
				<div class="table-responsive p-0">
					<table class="table align-items-center mb-0">
						<thead>
							<tr>
								<th class="align-middle text-center">병원명</th>
								<th class="align-middle text-center">남은 복용일</th>
								<th class="align-middle text-center">복용 상태</th>
								<th class="align-middle text-center">처방일자</th>
							</tr>
						</thead>
						<tbody>
							<tr>
								<td class="align-middle text-center" th:text="${u.hospital}">00병원</td>
								<td class="align-middle text-center" th:text="${u.dday} + '일'">5일</td>
								<td class="align-middle text-center"><span class="badge bg-gradient-secondary" th:text="${u.status}">복용중</span></td>
								<td class="align-middle text-center" th:text="${u.pdate}">22/07/18</td>
							</tr>
							
						</tbody>
					</table>
					<!-- 순응도바 -->
					<div class="progress text-center" id="bar_div">
					</div>
				</div>
			</div>
		</div>
		<!-- 복용 중지, 복용 완료 -->
		<div class="cardup card complete my-4" th:unless="${u.status == '복용중'}" th:onclick="|location.href='@{/pdetail(id=${u.id})}'|">
			<div id="pname" class="card-header p-0 position-relative mt-n4 mx-3 z-index-2">
				<div class="bg-gradient-primary shadow-primary border-radius-lg pt-4 pb-3">
					<h6 class="text-white text-capitalize ps-3" th:text="${u.hospital} + ' / ' + ${u.pdate}">
					처방 내역</h6>
					<p th:attrappend="id='p'+ ${u.id}" th:text="${u.id}" hidden="hidden"></p>
				</div>
			</div>
			<div class="card-body px-0 pb-2">
				<div class="table-responsive p-0">
					<table class="table align-items-center mb-0">
						<thead>
							<tr>
								<th class="align-middle text-center">병원명</th>
								<th class="align-middle text-center">남은 복용일</th>
								<th class="align-middle text-center">복용 상태</th>
								<th class="align-middle text-center">처방일자</th>
							</tr>
						</thead>
						<tbody>
							<tr>
								<td class="align-middle text-center" th:text="${u.hospital}">00병원</td>
								<td class="align-middle text-center" th:text="${u.dday} + '일'">5일</td>
								<td class="align-middle text-center"><span class="badge bg-gradient-secondary" th:text="${u.status}">복용중</span></td>
								<td class="align-middle text-center" th:text="${u.pdate}">22/07/18</td>
							</tr>
							
						</tbody>
					</table>
					<!-- 순응도바 -->
					<div class="progress text-center" id="bar_div">
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
