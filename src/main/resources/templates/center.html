<!DOCTYPE html>
<!-- Version: 5.0 -->
<!-- Description: 메인 페이지의 기본 중간 화면 (검색창)

-------------------------------------------------------------------------------
	Date			 Author							Note
-------------------------------------------------------------------------------
2022. 7. 15.	    noranbear				   First Creation

2022. 7. 16.							Bootstrap Dashboard page 탬플릿으로 바꿈

2022. 7. 18. 								  검색 페이지 화면 구성
                              				  main-logo path 변경

2022. 7. 19.		qwaszx357				  검색 결과 출력 화면 구성

2022. 7. 21.		noranbear				검색 결과 화면 출력 테스트 완료
		
2022. 7. 22.		noranbear			  getdataAJAXtest.html 내용을 
										  대입해서 테이블 내에 결과 출력하기	
										  							 
-------------------------------------------------------------------------------
-->

<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<meta charset="UTF-8">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

<!-- stylesheet -->
<link href="./assets/ezocss/centercss.css" rel="stylesheet" />


<script>
/**
 * 검색된 결과를 '검색 결과 div'에 출력하는 함수
 */
function display(data){
	var html= "";		// 출력할 html을 담을 변수
	var th = "text-center text-uppercase text-secondary font-weight-bolder'>";
	
	remove();		// 지우기

	// 1. 테이블 생성
	// div
	html += "<div class='card-body px-0 pb-2'>";
	html += "<div class='table-responsive'>";
	html += "<table class='table-fixed table align-items-center mb-0'>";
	// 헤더
	html += "<thead><tr>";
	html += "<th class='th-width1 " + th + "이미지</th>";
	html += "<th class='th-width2 " + th + "제품명</th>";
	html += "<th class='th-width3 " + th + "업체명</th>";
	html += "<th class='th-width4 " + th + "효능</th>";
	html += "</tr></thead>";
	
	// 바디
	html += "<tbody>";
	// 데이터 집어넣기
	$.each(data, function (i, item){
		var itemname = data[i].itemName;
		var imgurl = data[i].itemImage;
		var company = data[i].entpName;
		var efficacy = data[i].efcyQesitm;
		
		html += "<tr class='tr-height'>"
		html += "<td class='align-middle text-center'><img style='height:100px; width: 100px;' src='" + imgurl + "'></td>";
		html += "<td class='align-middle text-center'>"+ itemname +"</td>";
		html += "<td class='align-middle text-center'>"+ company +"</td>";
		html += "<td class='td-height align-middle text-center'>"+ efficacy +"</td>";
		html += "</tr>";
	});
	
	// close
	html += "<tbody>";
	html += "</table></div></div>";
	
	// 2. 생성된 테이블 출력
	$('#result-div').html(html);
}

/**
 * 기존에 있던 mid-div와 검색 결과를 지우는 함수
 */
function remove(){
	// 1. 중간 공간을 지워줌
	$('#remove-div').remove();
	
	// 2. 이전 출력 결과가 있다면 지워줌.
	$('#result-div').empty();
	// 또는
	//$('#this_div2').html("");	
}
/**
 * 검색된 결과를 받아 해당하는 약 데이터를 ajax로 가져오는 함수
 */
function getData(param){
	$.ajax({
		method: 'GET',
		url:'/dataget',
		data:{'item':param},
		dataType: 'json',
		success:function(data){
			// test
			//alert(data);
		 	console.log(data);
			display(data);	
		}
	});
	
};

$(document).ready(function(){
	
	/* 검색버튼 클릭 시, 약 데이터 불러오기 */
	$('#search_bt').click(function(){
		var param = $('#param').val();
		//alert(param);
		getData(param);
	});
	
});
</script>

<!-- 1. 로고 -->
<div class="int_t">
	<div class="int_tc">
		<img class="logo_img" alt="e약어때 로고" height="92" src="../img/main-logo.png" width="272">
	</div>
</div>

<!-- 2. 검색창 시작 -->
<div class="search-div">
	<form class="form-inline">
		<div class="col-lg-6 mx-auto">		
			<div class="search_box">
				<!-- 검색 분류 -->
				<select class="select-control">
					<option>전체</option>
					<option>제품명</option>
					<option>업체명</option>
					<option>효능</option>
				</select>
				<!-- 검색창 -->
				<div class="input-group input-group-lg input-group-outline py-3">
			  		<input type="text" id="param" class="form-control form-control-lg" placeholder="어떤 약을 찾으시나요?">
			  	</div>
			  	<a id="search_bt" class="btn bg-gradient-primary w-auto me-2"><i class="fas fa-search" aria-hidden="true"></i></a>
				
				<!-- OCR 스캔 시작 -->
			    <button id="scan_bt" type="button" class="btn btn-block bg-gradient-primary mb-3" data-bs-toggle="modal" data-bs-target="#modal-default"><i class="fa fa-camera"></i></button>
			    <!-- Modal 창 -->
			    <div class="modal fade" id="modal-default" tabindex="-1" role="dialog" aria-labelledby="modal-default" aria-hidden="true">
					<div class="modal-dialog modal- modal-dialog-centered modal-" role="document">
						<div class="modal-content">
							<div class="modal-header">
								<h6 class="modal-title" id="modal-title-default">Type your modal title</h6>
								<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close">
									<span aria-hidden="true">×</span>
								</button>
							</div>
							<div class="modal-body">
								<p>Far far away, behind the word mountains, far from the countries Vokalia and Consonantia, there live the blind texts. Separated they live in Bookmarksgrove right at the coast of the Semantics, a large language ocean.</p>
								<p>A small river named Duden flows by their place and supplies it with the necessary regelialia. It is a paradisematic country, in which roasted parts of sentences fly into your mouth.</p>
							</div>
							<div class="modal-footer">
								<button type="button" class="btn bg-gradient-primary">Save changes</button>
								<button type="button" class="btn btn-link  ml-auto" data-bs-dismiss="modal">Close</button>
							</div>
						</div>
					</div>
			    </div>
			    <!-- Modal 끝 -->
				<!-- OCR 스캔 끝 -->
			</div>
		</div>
	</form>
</div>
<!-- 2. 검색창 끝 -->

<!-- 3-1. 검색창과 풋터 사이의 여백 (검색전) -->
<div class="mid-div" id="remove-div"></div>

<!-- 3-2. 검색 결과 출력 시작 -->
<div class="search_card col-lg-8 col-10 mb-md-0 mb-4 mx-auto">
	<div class="card" id="result-div">
		<!-- 검색 결과가 출력되는 곳 -->
	</div>
</div>
<!-- 3-2. 검색 결과 출력 끝 -->

<!-- 4. Footer Start -->
<footer class="footer py-4  ">
	<div class="container-fluid">
		<div class="row align-items-center justify-content-lg-between">
			<div class="col-lg-6 mb-lg-0 mb-4">
				<div class="copyright text-center text-sm text-muted text-lg-start">
				© <script>
					document.write(new Date().getFullYear())
				</script>,
					made with <i class="fa fa-heart"></i> by
					<a href="https://www.creative-tim.com" class="font-weight-bold" target="_blank">Creative Tim</a>
					for a better web.
				</div>
			</div>
			<div class="col-lg-6">
				<ul class="nav nav-footer justify-content-center justify-content-lg-end">
					<li class="nav-item">
						<a href="https://www.creative-tim.com" class="nav-link text-muted" target="_blank">Creative Tim</a>
					</li>
					<li class="nav-item">
						<a href="https://www.creative-tim.com/presentation" class="nav-link text-muted" target="_blank">About Us</a>
					</li>
					<li class="nav-item">
						<a href="https://www.creative-tim.com/blog" class="nav-link text-muted" target="_blank">Blog</a>
					</li>
					<li class="nav-item">
						<a href="https://www.creative-tim.com/license" class="nav-link pe-0 text-muted" target="_blank">License</a>
					</li>
				</ul>
			</div>
		</div>
	</div>
</footer>
<!-- End Footer -->